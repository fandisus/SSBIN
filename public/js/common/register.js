app.controller("ctrlReg",["$scope",function(a){var b,c;a.user={email:"",username:"",name:"",pass:"",repass:"",gender:"",category:"",organization:""};var d=JSON.parse($("#init").html());$("#init").html("");a.categories=d.categories;a.organizations=[];a.tryRegister=function(){clearTimeout(b);clearTimeout(c);oPost={a:"register",user:a.user,token:token};tr.post("/register",oPost,function(a){$.notify(a.message);setTimeout(function(){window.location="/login"},5E3)},function(a){a.email_error?$(".forgot-link").show(1E3):
$(".forgot-link").hide(1E3)})};a.updateOrganizationSelect=function(){a.organizations=a.categories[a.user.category]};a.emailChanged=function(){clearTimeout(c);""!=a.email&&(c=setTimeout(a.checkEmail,1E3))};a.userChanged=function(){clearTimeout(b);""!=a.username&&(b=setTimeout(a.checkUsername,1E3))};a.checkUsername=function(){clearTimeout(b);oPost={a:"checkUsername",user:a.user.username,token:token};tr.post("/register",oPost,function(e){$("#user").notify("Username OK",{position:"top left"});a.$apply()},
function(a){$("#user").notify(a.message,{position:"top left",className:"error"})})};a.checkEmail=function(){clearTimeout(c);oPost={a:"checkEmail",email:a.user.email,token:token};tr.post("/register",oPost,function(a){$("#email").notify("Email OK",{position:"top left"});$(".forgot-link").hide(1E3)},function(a){$("#email").notify(a.message,{position:"top left",className:"error"});$(".forgot-link").show(1E3)})}}]);
