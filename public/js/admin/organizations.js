app.controller("ctrlOrg",["$scope",function(a){var c=JSON.parse($("#init").html());a.organizations=c.organizations;a.catList=c.catList;a.orgList=c.orgList;a.o={};a.target=null;$('[data-toggle="popover"]').popover();a.printDataInfo=printDataInfo;a.momenter=function(a){return moment(a).calendar()};a.edit=function(b){a.target=b;a.modalTitle="Edit category: "+b.category+", organization: "+b.name;a.o=angular.copy(b);$("#modalEdit").modal("show")};a.newO=function(){a.target=null;a.modalTitle="New Category/Organization";
a.o={category:"",name:""};$("#modalEdit").modal("show")};a.saveChanges=function(b){null==a.target?d(b):a.saveOld(b)};var d=function(b){tr.post("/admin/organizations",{a:"saveNew",o:b,token:token},function(b){a.organizations.push(b["new"]);$.notify(b.message,"success");$("#modalEdit").modal("hide");a.$apply()})};a.saveOld=function(b){tr.post("/admin/organizations",{a:"saveOld",o:b,target:a.target,token:token},function(b){a.target.category=b.o.category;a.target.name=b.o.name;a.target.data_info=b.o.data_info;
$.notify(b.message,"success");$("#modalEdit").modal("hide");a.$apply()})};a["delete"]=function(b){0!=confirm("Are you sure you want to delete?\nCategory: "+b.category+"\nOrganization: "+b.name)&&tr.post("/admin/organizations",{a:"delete",o:a.target,token:token},function(b){arrRemoveElement(a.organizations,a.target);$("#modalEdit").modal("hide");$.notify(b.message,"success");a.$apply()})}}]);
