app.controller("ctrlUsers",["$scope",function(a){var c=JSON.parse($("#init").html());$("#init").html("");a.users=c.users;a.levels=c.levels;a.categories=c.categories;a.organizations=[];a.classes=c.classes;a.u={};a.editUser={};a.updateOrganizationSelect=function(){a.organizations=a.categories[a.editUser.category]};a.toggleValidation=function(b){tr.post("/admin/users",{a:"toggleValidation",id:b.id,token:token},function(d){b.validated=d.validated;a.$apply()})};a.momenter=function(a){return moment(a).calendar()};
a.phoneLists=function(a){if(void 0!=a.biodata){var d="",c;for(c in a.biodata.phone)d+=a.biodata.phone[c]+"\n";return d}};a.show=function(b){a.u=b;$("#modalShowUser").modal("show")};a.edit=function(b){a.u=b;a.editUser=angular.copy(b);a.updateOrganizationSelect();$("#modalEdit").modal("show")};a.editExpertise=function(b){a.u=b;a.editUser=angular.copy(b);$("#modalExpertise").modal("show")};a.remExpertise=function(b){arrRemoveElement(a.editUser.expertise,b)};a.addClass=function(b){void 0!=b&&-1==a.editUser.expertise.indexOf(b)&&
a.editUser.expertise.push(b)};a.saveExpertise=function(b){tr.post("/admin/users",{a:"saveExpertise",u:{id:b.id,expertise:b.expertise},token:token},function(b){a.u.expertise=b.o.expertise;a.u.data_info=b.o.data_info;a.$apply();$("#modalExpertise").modal("hide");$.notify(b.message,"success")})};a.saveChanges=function(b){tr.post("/admin/users",{a:"save",u:{id:b.id,level:b.level,category:b.category,organization:b.organization},token:token},function(b){a.u.level=b.o.level;a.u.category=b.o.category;a.u.organization=
b.o.organization;a.u.data_info=b.o.data_info;a.$apply();$("#modalEdit").modal("hide");$.notify(b.message,"success")})};a.del=function(b){confirm("Are you sure?")&&tr.post("/admin/users",{a:"del",id:b.id,token:token},function(d){$.notify(d.message,"success");arrRemoveElement(a.users,b);a.$apply()})};a.activationEmail=function(a){tr.post("/admin/users",{a:"activationEmail",id:a,token:token},function(a){$.notify(a.message,"success")})}}]);
