app.controller("ctrlVisit",["$scope",function(b){var c=JSON.parse($("#init").html());b.logs=c.logs;b.types=c.types;b.pager={itemsPerPage:20,currentPage:1,totalItems:c.logs.length};(b.setPages=function(){var a=b.pager;console.log(a);a.totalPages=Math.ceil(a.totalItems/a.itemsPerPage);a.pages=[];for(var c=a.currentPage-2;c<=a.currentPage+2;c++)1<=c&&c<=a.totalPages&&a.pages.push(c);a.startRecord=0==a.totalItems?0:(a.currentPage-1)*a.itemsPerPage+1;a.endRecord=a.currentPage==a.totalPages?a.totalItems:
a.currentPage*a.itemsPerPage})();b.changePage=function(a){1>a||a>b.pager.totalPages||(b.pager.currentPage=a,b.setPages())};var c=moment().add(-1,"days").startOf("day").format("YYYY-MM-DD HH:mm:ss"),d=moment().add(-1,"days").endOf("day").format("YYYY-MM-DD HH:mm:ss");b.search={from:c,to:d,type:"All",ip:null,url:null,a:null};c=moment().add(-1,"months").startOf("day").format("YYYY-MM-DD HH:mm:ss");b.delDate=c;b.log={};b.showPost=function(a){b.log=a;$("#modalShowPostData").modal("show")};b.momenter=function(a){return moment(a).calendar()};
b.stringify=function(a){return JSON.stringify(a,void 0,2)};b.view=function(){tr.post("/admin/visitors",{a:"get",s:b.search,token:token},function(a){b.logs=a.logs;b.pager.totalItems=a.logs.length;b.pager.currentPage=1;b.setPages();b.$apply();$("#modalAdvSearch").modal("hide")})};b.del=function(){confirm("Are you sure?\nThis action cannot be undone")&&tr.post("/admin/visitors",{a:"del",d:b.delDate,token:token},function(a){$.notify(a.message,"success");$("#modalDelete").modal("hide")})}}]).filter("startFrom",
function(){return function(b,c){return b?b.slice(+c):[]}});
